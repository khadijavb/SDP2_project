import spacy
from spacy.matcher import Matcher

nlp = spacy.load('en_core_web_lg')

email_pattern = [{'LIKE_EMAIL': True}]
phone_pattern = [{'TEXT': {'REGEX': '^\\\\(?\\\\d{3}\\\\)?[.-]?\\\\d{3}[.-]?\\\\d{4}$'}}]
name_pattern = [{'POS': 'PROPN'}, {'POS': 'PROPN'}]
address_pattern = [{'TEXT': {'REGEX': '^[0-9]+\\\\s[A-z]+\\\\s[A-z]+'}}, {'IS_PUNCT': True}, {'TEXT': {'REGEX': '^[A-z]+,[A-z]{2,}$'}}]
education_pattern = [{'LOWER': {'IN': ['education', 'qualifications', 'certifications', 'courses', 'degree']}}]

experience_pattern = [{'LOWER': {'IN': ['work', 'experience', 'employment', 'career']}}]
matcher = Matcher(nlp.vocab)
matcher.add('EMAIL', None, email_pattern)
matcher.add('NAME', None, name_pattern)
matcher.add('ADDRESS', None, address_pattern)
matcher.add('EDUCATION', None, education_pattern)
matcher.add('EXPERIENCE', None, experience_pattern)

cv_text = '''
John Doe
123 Main Street
Anytown, USA 12345
johndoe@email.com
(555) 555-5555

Skills
- Python
- Java
- C++
- Machine learning
- Data analysis
- Project management

Experience
Software Engineer, XYZ Company, Jan 2022 - Present
- Developed and maintained web applications using Python and Django
- Implemented machine learning models to improve data analysis processes

Data Analyst, ABC Corporation, Jun 2020 - Dec 2021
- Analyzed customer data to identify trends and opportunities
- Built dashboards and visualizations to communicate insights to stakeholders

Project Manager, DEF Agency, Jan 2018 - May 2020
- Led cross-functional teams to deliver projects on time and within budget
- Managed project scope, schedule, and resources
'''

doc = nlp(cv_text)

matches = matcher(doc)

fields = {}
for match_id, start, end in matches:
    field_name = nlp.vocab.strings[match_id]
    fields[field_name] = doc[start:end].text

print(fields)
